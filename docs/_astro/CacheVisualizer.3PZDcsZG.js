import{j as t}from"./jsx-runtime.ClP7wGfN.js";import{r as o}from"./index.DK-fsZOb.js";import{A as _}from"./index.CMzh-1wI.js";import{m as x}from"./proxy.i6brGrIQ.js";const K=[{key:"LRU",label:"LRU",description:"Least Recently Used: Evicts the item that has not been accessed for the longest time."},{key:"LFU",label:"LFU",description:"Least Frequently Used: Evicts the item with the fewest total accesses."},{key:"FIFO",label:"FIFO",description:"First In First Out: Evicts the item that was added to the cache earliest."},{key:"Random",label:"Random",description:"Random: Evicts a random item from the cache. Simple but surprisingly effective."}],Z=["A","B","C","D","A","B","E","A","B","C","D","E","F","A","C","B","D","E","F","A"];function ee(g=640){const[y,C]=o.useState(!1);return o.useEffect(()=>{const h=window.matchMedia(`(max-width: ${g}px)`);C(h.matches);const I=k=>C(k.matches);return h.addEventListener("change",I),()=>h.removeEventListener("change",I)},[g]),y}function ne(){const g=ee(),[y,C]=o.useState("LRU"),[h,I]=o.useState(4),[k,b]=o.useState([]),[f,M]=o.useState(0),[p,U]=o.useState(0),[E,F]=o.useState([]),[m]=o.useState(Z),[d,O]=o.useState(-1),[j,S]=o.useState(!1),[A,V]=o.useState(50),T=o.useRef(0),R=o.useRef(0),w=o.useRef(null),P=o.useCallback((e,s)=>{if(e.length===0)return-1;switch(s){case"LRU":{let r=1/0,i=0;for(let n=0;n<e.length;n++)e[n].lastAccess<r&&(r=e[n].lastAccess,i=n);return i}case"LFU":{let r=1/0,i=1/0,n=0;for(let l=0;l<e.length;l++)(e[l].accessCount<r||e[l].accessCount===r&&e[l].lastAccess<i)&&(r=e[l].accessCount,i=e[l].lastAccess,n=l);return n}case"FIFO":{let r=1/0,i=0;for(let n=0;n<e.length;n++)e[n].insertOrder<r&&(r=e[n].insertOrder,i=n);return i}case"Random":return Math.floor(Math.random()*e.length)}},[]),q=o.useCallback((e,s)=>{switch(e){case"LRU":return`least recently accessed (last access: step ${s.lastAccess})`;case"LFU":return`least frequently accessed (${s.accessCount} accesses)`;case"FIFO":return`oldest entry (inserted at step ${s.insertOrder})`;case"Random":return"randomly selected for eviction"}},[]),D=o.useCallback(e=>{T.current++;const s=T.current;b(r=>{const i=r.findIndex(c=>c.key===e);if(i!==-1){M(a=>a+1);const c=r.map((a,u)=>u===i?{...a,lastAccess:s,accessCount:a.accessCount+1,flash:"hit"}:{...a,flash:null});return F(a=>[...a,{key:e,hit:!0,evicted:null,reason:`HIT - "${e}" found in cache`}]),setTimeout(()=>{b(a=>a.map(u=>u.key===e?{...u,flash:null}:u))},600),c}U(c=>c+1);let n=null,l="",v=[...r.map(c=>({...c,flash:null}))];if(v.length>=h){const c=P(v,y),a=v[c];return n=a.key,l=`MISS - "${e}" not in cache. Evicted "${n}" (${q(y,a)})`,v[c]={...v[c],flash:"evict"},setTimeout(()=>{b(u=>{const J=u.filter($=>$.key!==n);R.current++;const Q={key:e,insertOrder:R.current,lastAccess:s,accessCount:1,flash:"miss"},X=[...J,Q];return setTimeout(()=>{b($=>$.map(H=>H.key===e?{...H,flash:null}:H))},600),X})},400),F(u=>[...u,{key:e,hit:!1,evicted:n,reason:l}]),v}R.current++;const Y={key:e,insertOrder:R.current,lastAccess:s,accessCount:1,flash:"miss"};return l=`MISS - "${e}" not in cache. Added to empty slot.`,F(c=>[...c,{key:e,hit:!1,evicted:null,reason:l}]),setTimeout(()=>{b(c=>c.map(a=>a.key===e?{...a,flash:null}:a))},600),[...v,Y]})},[h,y,P,q]),B=o.useCallback(()=>{const e=d+1;if(e>=m.length){S(!1);return}O(e),D(m[e])},[d,m,D]);o.useEffect(()=>{if(!j){w.current&&clearTimeout(w.current);return}if(d>=m.length-1){S(!1);return}const e=Math.max(200,1500-A*13);return w.current=setTimeout(B,e),()=>{w.current&&clearTimeout(w.current)}},[j,d,m.length,A,B]);const z=o.useCallback(()=>{b([]),M(0),U(0),F([]),O(-1),S(!1),T.current=0,R.current=0},[]),W=f+p>0?(f/(f+p)*100).toFixed(1):"0.0",N=e=>({height:"1.75rem",display:"inline-flex",alignItems:"center",justifyContent:"center",borderRadius:"999px",padding:"0 0.75rem",border:e?"2px solid #0066cc":"2px solid var(--sl-color-gray-4)",background:e?"#0066cc":"transparent",color:e?"#fff":"var(--sl-color-text)",cursor:"pointer",fontSize:"0.72rem",fontWeight:600,transition:"all 0.15s",whiteSpace:"nowrap"}),L=(e,s=!1)=>({padding:"0.4rem 0.9rem",borderRadius:"6px",border:"none",background:s?"var(--sl-color-gray-5)":e,color:"#fff",fontWeight:600,fontSize:"0.8rem",cursor:s?"not-allowed":"pointer",opacity:s?.5:1,minHeight:36}),G=e=>e==="hit"?"#10b981":e==="miss"?"#f59e0b":e==="evict"?"#ef4444":"var(--sl-color-gray-5)";return t.jsxs("div",{style:{border:"1px solid var(--sl-color-gray-5)",borderRadius:"0.75rem",overflow:"hidden",margin:"1.5rem 0"},children:[t.jsxs("div",{style:{padding:"1rem 1.25rem",borderBottom:"1px solid var(--sl-color-gray-5)",background:"var(--sl-color-gray-6)"},children:[t.jsx("h3",{style:{margin:0,fontSize:"1.1rem",fontWeight:700},children:"Cache Eviction Visualizer"}),t.jsx("p",{style:{margin:"0.25rem 0 0",fontSize:"0.8rem",color:"var(--sl-color-gray-3)"},children:"Compare LRU, LFU, FIFO, and Random eviction policies step by step"})]}),t.jsxs("div",{style:{padding:"1.25rem"},children:[t.jsxs("div",{style:{marginBottom:"1rem"},children:[t.jsx("div",{style:{fontSize:"0.7rem",fontWeight:700,color:"var(--sl-color-gray-3)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"0.5rem"},children:"Eviction Policy"}),t.jsx("div",{style:{display:"flex",gap:"0.4rem",flexWrap:"wrap"},children:K.map(e=>t.jsx("button",{onClick:()=>{C(e.key),z()},style:N(y===e.key),children:e.label},e.key))})]}),t.jsx(_,{mode:"wait",children:t.jsx(x.div,{initial:{opacity:0,y:5},animate:{opacity:1,y:0},exit:{opacity:0,y:-5},style:{padding:"0.5rem 0.8rem",borderRadius:"6px",background:"#0066cc12",border:"1px solid #0066cc30",fontSize:"0.78rem",color:"var(--sl-color-gray-2)",marginBottom:"1rem",lineHeight:1.5},children:K.find(e=>e.key===y)?.description},y)}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"1rem",flexWrap:"wrap"},children:[t.jsx("label",{style:{fontSize:"0.8rem",fontWeight:600,whiteSpace:"nowrap"},children:"Cache Size:"}),t.jsx("div",{style:{display:"flex",gap:"0.3rem"},children:[2,3,4,5,6].map(e=>t.jsx("button",{onClick:()=>{I(e),z()},style:N(h===e),children:e},e))})]}),t.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap",marginBottom:"1.25rem",alignItems:"center"},children:[t.jsx("button",{style:L(j?"#ef4444":"#10b981"),onClick:()=>{d>=m.length-1?(z(),setTimeout(()=>S(!0),50)):S(e=>!e)},children:j?"Pause":d>=m.length-1?"Replay":"Play"}),t.jsx("button",{style:L("#0066cc",j||d>=m.length-1),onClick:B,disabled:j||d>=m.length-1,children:"Step"}),t.jsx("button",{style:L("var(--sl-color-gray-4)"),onClick:z,children:"Reset"}),t.jsxs("label",{style:{fontSize:"0.75rem",display:"flex",alignItems:"center",gap:"0.35rem",color:"var(--sl-color-gray-3)",marginLeft:"auto"},children:["Speed",t.jsx("input",{type:"range",min:10,max:100,value:A,onChange:e=>V(Number(e.target.value)),style:{width:g?"4rem":"5rem",accentColor:"#0066cc"}})]})]}),t.jsxs("div",{style:{marginBottom:"1.25rem"},children:[t.jsxs("div",{style:{fontSize:"0.7rem",fontWeight:700,color:"var(--sl-color-gray-3)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"0.5rem"},children:["Access Sequence (",d+1,"/",m.length,")"]}),t.jsx("div",{style:{display:"flex",gap:"0.25rem",flexWrap:"wrap"},children:m.map((e,s)=>{const r=s<=d,i=s===d,n=s===d+1,l=E[s]?.hit;return t.jsx(x.div,{animate:i?{scale:[1,1.15,1]}:{},transition:{duration:.3},style:{width:g?28:32,height:g?28:32,borderRadius:"6px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.75rem",fontWeight:700,border:i?"2px solid #0066cc":n?"2px dashed #0066cc50":r?`2px solid ${l?"#10b98180":"#ef444480"}`:"1px solid var(--sl-color-gray-5)",background:i?"#0066cc30":r?l?"#10b98118":"#ef444418":"transparent",color:i?"#0066cc":r?l?"#10b981":"#ef4444":"var(--sl-color-gray-3)",transition:"all 0.2s"},children:e},s)})})]}),t.jsxs("div",{style:{marginBottom:"1.25rem"},children:[t.jsxs("div",{style:{fontSize:"0.7rem",fontWeight:700,color:"var(--sl-color-gray-3)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"0.5rem"},children:["Cache (",k.length,"/",h," slots used)"]}),t.jsx("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:Array.from({length:h}).map((e,s)=>{const r=k[s],i=r?G(r.flash):"var(--sl-color-gray-5)";return t.jsx(x.div,{layout:!0,style:{width:g?70:90,minHeight:g?70:80,borderRadius:"10px",border:`2px solid ${r?i:"var(--sl-color-gray-5)"}`,background:r?.flash?`${i}20`:r?"var(--sl-color-gray-6)":"transparent",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"0.5rem",transition:"all 0.25s",boxShadow:r?.flash?`0 0 12px ${i}40`:"none"},children:t.jsx(_,{mode:"wait",children:r?t.jsxs(x.div,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},exit:{scale:0,opacity:0},style:{textAlign:"center"},children:[t.jsx("div",{style:{fontSize:"1.2rem",fontWeight:800,color:i!=="var(--sl-color-gray-5)"?i:"var(--sl-color-text)"},children:r.key}),t.jsxs("div",{style:{fontSize:"0.6rem",color:"var(--sl-color-gray-3)",marginTop:"0.15rem",lineHeight:1.4},children:[t.jsxs("div",{children:["freq: ",r.accessCount]}),t.jsxs("div",{children:["last: ",r.lastAccess]})]})]},r.key):t.jsx(x.div,{style:{fontSize:"0.7rem",color:"var(--sl-color-gray-4)"},children:"empty"},"empty")})},s)})})]}),t.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap",marginBottom:"1.25rem"},children:[[{label:"Hits",value:f,color:"#10b981"},{label:"Misses",value:p,color:"#ef4444"},{label:"Hit Ratio",value:`${W}%`,color:"#0066cc"}].map(e=>t.jsxs("div",{style:{flex:"1 1 80px",padding:"0.6rem 0.75rem",borderRadius:"8px",background:`${e.color}12`,border:`1px solid ${e.color}40`,textAlign:"center"},children:[t.jsx("div",{style:{fontSize:"0.65rem",fontWeight:600,color:"var(--sl-color-gray-3)",textTransform:"uppercase",marginBottom:"0.2rem"},children:e.label}),t.jsx("div",{style:{fontSize:"1.2rem",fontWeight:800,color:e.color,fontFamily:"monospace"},children:e.value})]},e.label)),t.jsxs("div",{style:{flex:"2 1 180px",padding:"0.6rem 0.75rem",borderRadius:"8px",background:"var(--sl-color-gray-6)",border:"1px solid var(--sl-color-gray-5)"},children:[t.jsx("div",{style:{fontSize:"0.65rem",fontWeight:600,color:"var(--sl-color-gray-3)",textTransform:"uppercase",marginBottom:"0.4rem"},children:"Hit / Miss Distribution"}),t.jsxs("div",{style:{height:12,borderRadius:6,background:"var(--sl-color-gray-5)",overflow:"hidden",display:"flex"},children:[t.jsx(x.div,{animate:{width:`${f+p>0?f/(f+p)*100:0}%`},style:{height:"100%",background:"#10b981",borderRadius:"6px 0 0 6px"},transition:{duration:.3}}),t.jsx(x.div,{animate:{width:`${f+p>0?p/(f+p)*100:0}%`},style:{height:"100%",background:"#ef4444"},transition:{duration:.3}})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"0.2rem",fontSize:"0.65rem"},children:[t.jsxs("span",{style:{color:"#10b981"},children:["Hit ",W,"%"]}),t.jsxs("span",{style:{color:"#ef4444"},children:["Miss ",f+p>0?(100-parseFloat(W)).toFixed(1):"0.0","%"]})]})]})]}),t.jsxs("div",{children:[t.jsx("div",{style:{fontSize:"0.7rem",fontWeight:700,color:"var(--sl-color-gray-3)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"0.5rem"},children:"Access History"}),t.jsxs("div",{style:{background:"var(--sl-color-gray-7, #0d1117)",border:"1px solid var(--sl-color-gray-5)",borderRadius:"8px",padding:"0.6rem 0.75rem",maxHeight:160,overflowY:"auto",fontFamily:"monospace",fontSize:"0.72rem",lineHeight:1.7},children:[E.length===0&&t.jsx("span",{style:{color:"var(--sl-color-gray-4)"},children:"Click Play or Step to begin accessing the cache..."}),E.map((e,s)=>t.jsxs(x.div,{initial:{opacity:0,x:-8},animate:{opacity:1,x:0},style:{color:e.hit?"#10b981":"#ef4444"},children:[t.jsxs("span",{style:{color:"var(--sl-color-gray-4)",marginRight:"0.4rem"},children:["[",String(s+1).padStart(2,"0"),"]"]}),t.jsx("span",{style:{display:"inline-block",padding:"0 0.3rem",borderRadius:"3px",background:e.hit?"#10b98120":"#ef444420",fontSize:"0.65rem",fontWeight:700,marginRight:"0.3rem"},children:e.hit?"HIT":"MISS"}),e.reason]},s))]})]})]})]})}export{ne as default};
